<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Packet (udns.Udns.Packet)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">udns</a> &#x00BB; <a href="../index.html">Udns</a> &#x00BB; Packet</nav><h1>Module <code>Udns.Packet</code></h1><p>The DNS packet.</p><p>Encoding and decoding from binary. Definition of types for multiple DNS operations.</p></header><dl><dt class="spec type" id="type-err"><a href="#type-err" class="anchor"></a><code><span class="keyword">type</span> err</code> = <code>[ </code><table class="variant"><tr id="type-err.Not_implemented" class="anchored"><td class="def constructor"><a href="#type-err.Not_implemented" class="anchor"></a><code>| </code><code>`Not_implemented <span class="keyword">of</span> int * string</code></td></tr><tr id="type-err.Leftover" class="anchored"><td class="def constructor"><a href="#type-err.Leftover" class="anchor"></a><code>| </code><code>`Leftover <span class="keyword">of</span> int * string</code></td></tr><tr id="type-err.Malformed" class="anchored"><td class="def constructor"><a href="#type-err.Malformed" class="anchor"></a><code>| </code><code>`Malformed <span class="keyword">of</span> int * string</code></td></tr><tr id="type-err.Partial" class="anchored"><td class="def constructor"><a href="#type-err.Partial" class="anchor"></a><code>| </code><code>`Partial</code></td></tr><tr id="type-err.Bad_edns_version" class="anchored"><td class="def constructor"><a href="#type-err.Bad_edns_version" class="anchor"></a><code>| </code><code>`Bad_edns_version <span class="keyword">of</span> int</code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-pp_err"><a href="#val-pp_err" class="anchor"></a><code><span class="keyword">val</span> pp_err : <a href="index.html#type-err">err</a> Fmt.t</code></dt></dl><div class="spec module" id="module-Header"><a href="#module-Header" class="anchor"></a><code><span class="keyword">module</span> <a href="Header/index.html">Header</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="spec module" id="module-Question"><a href="#module-Question" class="anchor"></a><code><span class="keyword">module</span> <a href="Question/index.html">Question</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="spec module" id="module-Query"><a href="#module-Query" class="anchor"></a><code><span class="keyword">module</span> <a href="Query/index.html">Query</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="spec module" id="module-Axfr"><a href="#module-Axfr" class="anchor"></a><code><span class="keyword">module</span> <a href="Axfr/index.html">Axfr</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="spec module" id="module-Update"><a href="#module-Update" class="anchor"></a><code><span class="keyword">module</span> <a href="Update/index.html">Update</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code> = <code>[ </code><table class="variant"><tr id="type-t.Query" class="anchored"><td class="def constructor"><a href="#type-t.Query" class="anchor"></a><code>| </code><code>`Query <span class="keyword">of</span> <a href="Query/index.html#type-t">Query.t</a></code></td></tr><tr id="type-t.Notify" class="anchored"><td class="def constructor"><a href="#type-t.Notify" class="anchor"></a><code>| </code><code>`Notify <span class="keyword">of</span> <a href="Query/index.html#type-t">Query.t</a></code></td></tr><tr id="type-t.Axfr" class="anchored"><td class="def constructor"><a href="#type-t.Axfr" class="anchor"></a><code>| </code><code>`Axfr <span class="keyword">of</span> <a href="Axfr/index.html#type-t">Axfr.t</a></code></td></tr><tr id="type-t.Update" class="anchored"><td class="def constructor"><a href="#type-t.Update" class="anchor"></a><code>| </code><code>`Update <span class="keyword">of</span> <a href="Update/index.html#type-t">Update.t</a></code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span class="keyword">val</span> pp : <a href="index.html#type-t">t</a> Fmt.t</code></dt><dt class="spec value" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span class="keyword">val</span> equal : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt></dl><dl><dt class="spec type" id="type-res"><a href="#type-res" class="anchor"></a><code><span class="keyword">type</span> res</code><code> = <a href="Header/index.html#type-t">Header.t</a> * <a href="Question/index.html#type-t">Question.t</a> * <a href="index.html#type-t">t</a> * <a href="../Name_rr_map/index.html#type-t">Name_rr_map.t</a> * <a href="../Edns/index.html#type-t">Edns.t</a> option * (Domain_name.t * <a href="../Tsig/index.html#type-t">Tsig.t</a> * int) option</code></dt></dl><dl><dt class="spec value" id="val-pp_res"><a href="#val-pp_res" class="anchor"></a><code><span class="keyword">val</span> pp_res : <a href="index.html#type-res">res</a> Fmt.t</code></dt><dt class="spec value" id="val-decode"><a href="#val-decode" class="anchor"></a><code><span class="keyword">val</span> decode : Cstruct.t <span>&#45;&gt;</span> (<a href="index.html#type-res">res</a>, <a href="index.html#type-err">err</a>) Stdlib.result</code></dt><dt class="spec value" id="val-is_reply"><a href="#val-is_reply" class="anchor"></a><code><span class="keyword">val</span> is_reply : ?&#8288;not_error:bool <span>&#45;&gt;</span> ?&#8288;not_truncated:bool <span>&#45;&gt;</span> <a href="Header/index.html#type-t">Header.t</a> <span>&#45;&gt;</span> <a href="Question/index.html#type-t">Question.t</a> <span>&#45;&gt;</span> <a href="index.html#type-res">res</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>is_reply ~not_error ~not_truncated header question response</code> validates the reply, and returns either <code>true</code> or <code>false</code> and logs the failure. The following basic checks are performed:</p><ul><li>Is the header identifier of <code>header</code> and <code>response</code> equal?</li><li>Is <code>res</code> a reply (first bit set)?</li><li>Is the operation of <code>header</code> and <code>res</code> the same?</li><li>If <code>not_error</code> is <code>true</code> (the default): is the rcode of <code>header</code> NoError?</li><li>If <code>not_truncated</code> is <code>true</code> (the default): is the <code>truncation</code> flag not set?</li><li>Is the <code>question</code> and the question of <code>response</code> equal?</li></ul></dd></dl><dl><dt class="spec value" id="val-size_edns"><a href="#val-size_edns" class="anchor"></a><code><span class="keyword">val</span> size_edns : int option <span>&#45;&gt;</span> <a href="../Edns/index.html#type-t">Edns.t</a> option <span>&#45;&gt;</span> <a href="../index.html#type-proto">proto</a> <span>&#45;&gt;</span> bool <span>&#45;&gt;</span> int * <a href="../Edns/index.html#type-t">Edns.t</a> option</code></dt><dt class="spec value" id="val-encode"><a href="#val-encode" class="anchor"></a><code><span class="keyword">val</span> encode : ?&#8288;max_size:int <span>&#45;&gt;</span> ?&#8288;additional:<a href="../Name_rr_map/index.html#type-t">Name_rr_map.t</a> <span>&#45;&gt;</span> ?&#8288;edns:<a href="../Edns/index.html#type-t">Edns.t</a> <span>&#45;&gt;</span> <a href="../index.html#type-proto">proto</a> <span>&#45;&gt;</span> <a href="Header/index.html#type-t">Header.t</a> <span>&#45;&gt;</span> <a href="Question/index.html#type-t">Question.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Cstruct.t * int</code></dt><dt class="spec value" id="val-error"><a href="#val-error" class="anchor"></a><code><span class="keyword">val</span> error : <a href="Header/index.html#type-t">Header.t</a> <span>&#45;&gt;</span> <a href="Question/index.html#type-t">Question.t</a> <span>&#45;&gt;</span> <a href="../../Udns_enum/index.html#type-rcode">Udns_enum.rcode</a> <span>&#45;&gt;</span> (Cstruct.t * int) option</code></dt><dt class="spec value" id="val-raw_error"><a href="#val-raw_error" class="anchor"></a><code><span class="keyword">val</span> raw_error : Cstruct.t <span>&#45;&gt;</span> <a href="../../Udns_enum/index.html#type-rcode">Udns_enum.rcode</a> <span>&#45;&gt;</span> Cstruct.t option</code></dt></dl></div></body></html>