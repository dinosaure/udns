<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Udns_packet (udns.Udns_packet)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">udns</a> &#x00BB; Udns_packet</nav><h1>Module <code>Udns_packet</code></h1></header><dl><dt class="spec type" id="type-proto"><a href="#type-proto" class="anchor"></a><code><span class="keyword">type </span>proto</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-proto.Tcp" class="anchored"><td class="def constructor"><a href="#type-proto.Tcp" class="anchor"></a><code><span class="keyword">| </span></code><code>`Tcp</code></td></tr><tr id="type-proto.Udp" class="anchored"><td class="def constructor"><a href="#type-proto.Udp" class="anchor"></a><code><span class="keyword">| </span></code><code>`Udp</code></td></tr></table><code> ]</code></dt><dd><p>The type of support protocols (influence maximum packet size, encoding, etc.).</p></dd></dl><dl><dt class="spec value" id="val-pp_err"><a href="#val-pp_err" class="anchor"></a><code><span class="keyword">val </span>pp_err : [&lt; <a href="../Udns_name/index.html#type-err">Udns_name.err</a><span class="keyword"> | </span>`BadTTL of int32<span class="keyword"> | </span>`BadRRTyp of int<span class="keyword"> | </span>`DisallowedRRTyp of <a href="../Udns_enum/index.html#type-rr_typ">Udns_enum.rr_typ</a><span class="keyword"> | </span>`BadClass of int<span class="keyword"> | </span>`DisallowedClass of <a href="../Udns_enum/index.html#type-clas">Udns_enum.clas</a><span class="keyword"> | </span>`UnsupportedClass of <a href="../Udns_enum/index.html#type-clas">Udns_enum.clas</a><span class="keyword"> | </span>`BadOpcode of int<span class="keyword"> | </span>`UnsupportedOpcode of <a href="../Udns_enum/index.html#type-opcode">Udns_enum.opcode</a><span class="keyword"> | </span>`BadRcode of int<span class="keyword"> | </span>`BadCaaTag<span class="keyword"> | </span>`LeftOver<span class="keyword"> | </span>`NonZeroTTL of int32<span class="keyword"> | </span>`NonZeroRdlen of int<span class="keyword"> | </span>`InvalidZoneCount of int<span class="keyword"> | </span>`InvalidZoneRR of <a href="../Udns_enum/index.html#type-rr_typ">Udns_enum.rr_typ</a><span class="keyword"> | </span>`InvalidTimestamp of int64<span class="keyword"> | </span>`InvalidAlgorithm of Domain_name.t<span class="keyword"> | </span>`BadProto of int<span class="keyword"> | </span>`BadAlgorithm of int<span class="keyword"> | </span>`BadOpt<span class="keyword"> | </span>`BadKeepalive<span class="keyword"> | </span>`BadTlsaCertUsage of int<span class="keyword"> | </span>`BadTlsaSelector of int<span class="keyword"> | </span>`BadTlsaMatchingType of int<span class="keyword"> | </span>`BadSshfpAlgorithm of int<span class="keyword"> | </span>`BadSshfpType of int<span class="keyword"> | </span>`Bad_edns_version of int<span class="keyword"> | </span>`Multiple_tsig<span class="keyword"> | </span>`Multiple_edns<span class="keyword"> | </span>`Tsig_not_last ] Fmt.t</code></dt><dd><p><code>pp_err ppf err</code> pretty-prints the <code>err</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec type" id="type-header"><a href="#type-header" class="anchor"></a><code><span class="keyword">type </span>header</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-header.id" class="anchored"><td class="def field"><a href="#type-header.id" class="anchor"></a><code>id : int;</code></td></tr><tr id="type-header.query" class="anchored"><td class="def field"><a href="#type-header.query" class="anchor"></a><code>query : bool;</code></td></tr><tr id="type-header.operation" class="anchored"><td class="def field"><a href="#type-header.operation" class="anchor"></a><code>operation : <a href="../Udns_enum/index.html#type-opcode">Udns_enum.opcode</a>;</code></td></tr><tr id="type-header.authoritative" class="anchored"><td class="def field"><a href="#type-header.authoritative" class="anchor"></a><code>authoritative : bool;</code></td></tr><tr id="type-header.truncation" class="anchored"><td class="def field"><a href="#type-header.truncation" class="anchor"></a><code>truncation : bool;</code></td></tr><tr id="type-header.recursion_desired" class="anchored"><td class="def field"><a href="#type-header.recursion_desired" class="anchor"></a><code>recursion_desired : bool;</code></td></tr><tr id="type-header.recursion_available" class="anchored"><td class="def field"><a href="#type-header.recursion_available" class="anchor"></a><code>recursion_available : bool;</code></td></tr><tr id="type-header.authentic_data" class="anchored"><td class="def field"><a href="#type-header.authentic_data" class="anchor"></a><code>authentic_data : bool;</code></td></tr><tr id="type-header.checking_disabled" class="anchored"><td class="def field"><a href="#type-header.checking_disabled" class="anchor"></a><code>checking_disabled : bool;</code></td></tr><tr id="type-header.rcode" class="anchored"><td class="def field"><a href="#type-header.rcode" class="anchor"></a><code>rcode : <a href="../Udns_enum/index.html#type-rcode">Udns_enum.rcode</a>;</code></td></tr></table><code>}</code></dt><dd><p>The header of a DNS packet: it's identifer, query or response, operation, flags, and return code.</p></dd></dl><dl><dt class="spec value" id="val-pp_header"><a href="#val-pp_header" class="anchor"></a><code><span class="keyword">val </span>pp_header : <a href="index.html#type-header">header</a> Fmt.t</code></dt><dd><p><code>pp_header ppf header</code> pretty-prints <code>header</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec value" id="val-encode_header"><a href="#val-encode_header" class="anchor"></a><code><span class="keyword">val </span>encode_header : Cstruct.t <span>&#45;&gt;</span> <a href="index.html#type-header">header</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>encode_header buf header</code> encodes the <code>header</code> into <code>buf</code> at offset 0. Raises an exception if the buffer is too small.</p></dd></dl><dl><dt class="spec value" id="val-decode_header"><a href="#val-decode_header" class="anchor"></a><code><span class="keyword">val </span>decode_header : Cstruct.t <span>&#45;&gt;</span> (<a href="index.html#type-header">header</a>, [&gt; `Partial<span class="keyword"> | </span>`BadOpcode of int<span class="keyword"> | </span>`BadRcode of int ]) Stdlib.result</code></dt><dd><p><code>decode_header buf</code> decodes the buffer at offset 0 and returns either a header or an error.</p></dd></dl><dl><dt class="spec type" id="type-question"><a href="#type-question" class="anchor"></a><code><span class="keyword">type </span>question</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-question.q_name" class="anchored"><td class="def field"><a href="#type-question.q_name" class="anchor"></a><code>q_name : Domain_name.t;</code></td></tr><tr id="type-question.q_type" class="anchored"><td class="def field"><a href="#type-question.q_type" class="anchor"></a><code>q_type : <a href="../Udns_enum/index.html#type-rr_typ">Udns_enum.rr_typ</a>;</code></td></tr></table><code>}</code></dt><dd><p>The type of DNS questions: a domain-name and a resource record type. The class is always IN.</p></dd></dl><dl><dt class="spec value" id="val-decode_question"><a href="#val-decode_question" class="anchor"></a><code><span class="keyword">val </span>decode_question : (Domain_name.t<span class="keyword"> * </span>int) <a href="../Udns_name/index.html#module-IntMap">Udns_name.IntMap</a>.t <span>&#45;&gt;</span> Cstruct.t <span>&#45;&gt;</span> int <span>&#45;&gt;</span> (<a href="index.html#type-question">question</a><span class="keyword"> * </span>(Domain_name.t<span class="keyword"> * </span>int) <a href="../Udns_name/index.html#module-IntMap">Udns_name.IntMap</a>.t<span class="keyword"> * </span>int, [&gt; `BadClass of Cstruct.uint16<span class="keyword"> | </span>`BadContent of string<span class="keyword"> | </span>`BadOffset of int<span class="keyword"> | </span>`BadRRTyp of Cstruct.uint16<span class="keyword"> | </span>`BadTag of int<span class="keyword"> | </span>`Partial<span class="keyword"> | </span>`TooLong<span class="keyword"> | </span>`UnsupportedClass of <a href="../Udns_enum/index.html#type-clas">Udns_enum.clas</a> ]) Stdlib.result</code></dt><dd><p><code>decode_question names buffer offset</code> decodes a question at <code>offset</code> from <code>buffer</code>, applying label decompression. The new offset and offset to names map are returned together with the question, or an error.</p></dd></dl><dl><dt class="spec value" id="val-pp_question"><a href="#val-pp_question" class="anchor"></a><code><span class="keyword">val </span>pp_question : <a href="index.html#type-question">question</a> Fmt.t</code></dt><dd><p><code>pp_question ppf question</code> pretty-prints the <code>question</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec type" id="type-soa"><a href="#type-soa" class="anchor"></a><code><span class="keyword">type </span>soa</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-soa.nameserver" class="anchored"><td class="def field"><a href="#type-soa.nameserver" class="anchor"></a><code>nameserver : Domain_name.t;</code></td></tr><tr id="type-soa.hostmaster" class="anchored"><td class="def field"><a href="#type-soa.hostmaster" class="anchor"></a><code>hostmaster : Domain_name.t;</code></td></tr><tr id="type-soa.serial" class="anchored"><td class="def field"><a href="#type-soa.serial" class="anchor"></a><code>serial : int32;</code></td></tr><tr id="type-soa.refresh" class="anchored"><td class="def field"><a href="#type-soa.refresh" class="anchor"></a><code>refresh : int32;</code></td></tr><tr id="type-soa.retry" class="anchored"><td class="def field"><a href="#type-soa.retry" class="anchor"></a><code>retry : int32;</code></td></tr><tr id="type-soa.expiry" class="anchored"><td class="def field"><a href="#type-soa.expiry" class="anchor"></a><code>expiry : int32;</code></td></tr><tr id="type-soa.minimum" class="anchored"><td class="def field"><a href="#type-soa.minimum" class="anchor"></a><code>minimum : int32;</code></td></tr></table><code>}</code></dt><dd><p>The type of a start of authority (SOA) entry.</p></dd></dl><dl><dt class="spec value" id="val-pp_soa"><a href="#val-pp_soa" class="anchor"></a><code><span class="keyword">val </span>pp_soa : <a href="index.html#type-soa">soa</a> Fmt.t</code></dt><dd><p><code>pp_soa ppf soa</code> pretty-prints the <code>soa</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec value" id="val-compare_soa"><a href="#val-compare_soa" class="anchor"></a><code><span class="keyword">val </span>compare_soa : <a href="index.html#type-soa">soa</a> <span>&#45;&gt;</span> <a href="index.html#type-soa">soa</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>compare_soa soa soa'</code> compares the serial, nameserver, hostmaster, refresh, retry, expiry, and minimum of two SOA records.</p></dd></dl><dl><dt class="spec type" id="type-tsig_algo"><a href="#type-tsig_algo" class="anchor"></a><code><span class="keyword">type </span>tsig_algo</code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-tsig_algo.SHA1" class="anchored"><td class="def constructor"><a href="#type-tsig_algo.SHA1" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">SHA1</span></code></td></tr><tr id="type-tsig_algo.SHA224" class="anchored"><td class="def constructor"><a href="#type-tsig_algo.SHA224" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">SHA224</span></code></td></tr><tr id="type-tsig_algo.SHA256" class="anchored"><td class="def constructor"><a href="#type-tsig_algo.SHA256" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">SHA256</span></code></td></tr><tr id="type-tsig_algo.SHA384" class="anchored"><td class="def constructor"><a href="#type-tsig_algo.SHA384" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">SHA384</span></code></td></tr><tr id="type-tsig_algo.SHA512" class="anchored"><td class="def constructor"><a href="#type-tsig_algo.SHA512" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">SHA512</span></code></td><td class="doc"><p>The type of TSIG algorithms.</p></td></tr></table></dt></dl><dl><dt class="spec value" id="val-pp_tsig_algo"><a href="#val-pp_tsig_algo" class="anchor"></a><code><span class="keyword">val </span>pp_tsig_algo : <a href="index.html#type-tsig_algo">tsig_algo</a> Fmt.t</code></dt><dd><p><code>pp_tsig_algo ppf algo</code> pretty-prints the <code>algo</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec type" id="type-tsig"><a href="#type-tsig" class="anchor"></a><code><span class="keyword">type </span>tsig</code><code><span class="keyword"> = </span><span class="keyword">private </span></code><code>{</code><table class="record"><tr id="type-tsig.algorithm" class="anchored"><td class="def field"><a href="#type-tsig.algorithm" class="anchor"></a><code>algorithm : <a href="index.html#type-tsig_algo">tsig_algo</a>;</code></td></tr><tr id="type-tsig.signed" class="anchored"><td class="def field"><a href="#type-tsig.signed" class="anchor"></a><code>signed : Ptime.t;</code></td></tr><tr id="type-tsig.fudge" class="anchored"><td class="def field"><a href="#type-tsig.fudge" class="anchor"></a><code>fudge : Ptime.Span.t;</code></td></tr><tr id="type-tsig.mac" class="anchored"><td class="def field"><a href="#type-tsig.mac" class="anchor"></a><code>mac : Cstruct.t;</code></td></tr><tr id="type-tsig.original_id" class="anchored"><td class="def field"><a href="#type-tsig.original_id" class="anchor"></a><code>original_id : int;</code></td></tr><tr id="type-tsig.error" class="anchored"><td class="def field"><a href="#type-tsig.error" class="anchor"></a><code>error : <a href="../Udns_enum/index.html#type-rcode">Udns_enum.rcode</a>;</code></td></tr><tr id="type-tsig.other" class="anchored"><td class="def field"><a href="#type-tsig.other" class="anchor"></a><code>other : Ptime.t option;</code></td></tr></table><code>}</code></dt><dd><p>The type of TSIG signatures.</p></dd></dl><dl><dt class="spec value" id="val-valid_time"><a href="#val-valid_time" class="anchor"></a><code><span class="keyword">val </span>valid_time : Ptime.t <span>&#45;&gt;</span> <a href="index.html#type-tsig">tsig</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>valid_time now tsig</code> checks whether the tsig timestamp is within <code>now - fudge &lt; timstamp &amp;&amp; timestamp &lt; now + fudge</code></p></dd></dl><dl><dt class="spec value" id="val-tsig"><a href="#val-tsig" class="anchor"></a><code><span class="keyword">val </span>tsig : algorithm:<a href="index.html#type-tsig_algo">tsig_algo</a> <span>&#45;&gt;</span> signed:Ptime.t <span>&#45;&gt;</span> ?&#8288;fudge:Ptime.Span.t <span>&#45;&gt;</span> ?&#8288;mac:Cstruct.t <span>&#45;&gt;</span> ?&#8288;original_id:int <span>&#45;&gt;</span> ?&#8288;error:<a href="../Udns_enum/index.html#type-rcode">Udns_enum.rcode</a> <span>&#45;&gt;</span> ?&#8288;other:Ptime.t <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="index.html#type-tsig">tsig</a> option</code></dt><dd><p><code>tsig ~algorithm ~signed ~fudge ~mac ~original_id ~error ~other ()</code> constructs a tsig if timestamp and fudge fit into their ranges.</p></dd></dl><dl><dt class="spec value" id="val-with_mac"><a href="#val-with_mac" class="anchor"></a><code><span class="keyword">val </span>with_mac : <a href="index.html#type-tsig">tsig</a> <span>&#45;&gt;</span> Cstruct.t <span>&#45;&gt;</span> <a href="index.html#type-tsig">tsig</a></code></dt><dd><p><code>with_mac tsig mac</code> replaces the <code>mac</code> field of <code>tsig</code> with the provided one.</p></dd></dl><dl><dt class="spec value" id="val-with_error"><a href="#val-with_error" class="anchor"></a><code><span class="keyword">val </span>with_error : <a href="index.html#type-tsig">tsig</a> <span>&#45;&gt;</span> <a href="../Udns_enum/index.html#type-rcode">Udns_enum.rcode</a> <span>&#45;&gt;</span> <a href="index.html#type-tsig">tsig</a></code></dt><dd><p><code>with_error tsig error</code> replaces the <code>error</code> field of <code>tsig</code> with the provided one.</p></dd></dl><dl><dt class="spec value" id="val-with_signed"><a href="#val-with_signed" class="anchor"></a><code><span class="keyword">val </span>with_signed : <a href="index.html#type-tsig">tsig</a> <span>&#45;&gt;</span> Ptime.t <span>&#45;&gt;</span> <a href="index.html#type-tsig">tsig</a> option</code></dt><dd><p><code>with_signed tsig signed</code> replaces the <code>signed</code> field of <code>tsig</code> with the provided one.</p></dd></dl><dl><dt class="spec value" id="val-with_other"><a href="#val-with_other" class="anchor"></a><code><span class="keyword">val </span>with_other : <a href="index.html#type-tsig">tsig</a> <span>&#45;&gt;</span> Ptime.t option <span>&#45;&gt;</span> <a href="index.html#type-tsig">tsig</a> option</code></dt><dd><p><code>with_other tsig now</code> replaces the <code>other</code> field of <code>tsig</code> with the provided one.</p></dd></dl><dl><dt class="spec value" id="val-pp_tsig"><a href="#val-pp_tsig" class="anchor"></a><code><span class="keyword">val </span>pp_tsig : <a href="index.html#type-tsig">tsig</a> Fmt.t</code></dt><dd><p><code>pp_tsig ppf tsig</code> pretty-prints the <code>tsig</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec value" id="val-encode_raw_tsig"><a href="#val-encode_raw_tsig" class="anchor"></a><code><span class="keyword">val </span>encode_raw_tsig : Domain_name.t <span>&#45;&gt;</span> <a href="index.html#type-tsig">tsig</a> <span>&#45;&gt;</span> Cstruct.t</code></dt><dd><p><code>encode_raw_tsig name tsig</code> is the encoded header to be used to compute signatures.</p></dd></dl><dl><dt class="spec value" id="val-encode_full_tsig"><a href="#val-encode_full_tsig" class="anchor"></a><code><span class="keyword">val </span>encode_full_tsig : Domain_name.t <span>&#45;&gt;</span> <a href="index.html#type-tsig">tsig</a> <span>&#45;&gt;</span> Cstruct.t</code></dt><dd><p><code>encode_full_tsig name tsig</code> is the encoded <code>tsig</code> resource record.</p></dd></dl><dl><dt class="spec type" id="type-dnskey"><a href="#type-dnskey" class="anchor"></a><code><span class="keyword">type </span>dnskey</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-dnskey.flags" class="anchored"><td class="def field"><a href="#type-dnskey.flags" class="anchor"></a><code>flags : int;</code></td></tr><tr id="type-dnskey.key_algorithm" class="anchored"><td class="def field"><a href="#type-dnskey.key_algorithm" class="anchor"></a><code>key_algorithm : <a href="../Udns_enum/index.html#type-dnskey">Udns_enum.dnskey</a>;</code></td></tr><tr id="type-dnskey.key" class="anchored"><td class="def field"><a href="#type-dnskey.key" class="anchor"></a><code>key : Cstruct.t;</code></td></tr></table><code>}</code></dt><dd><p>The type of dnskey resource records.</p></dd></dl><dl><dt class="spec value" id="val-dnskey_of_string"><a href="#val-dnskey_of_string" class="anchor"></a><code><span class="keyword">val </span>dnskey_of_string : string <span>&#45;&gt;</span> <a href="index.html#type-dnskey">dnskey</a> option</code></dt><dd><p><code>dnskey_of_string str</code> parses <code>str</code> from <code>flags:</code>algorithm:base64-key.</p></dd></dl><dl><dt class="spec value" id="val-name_dnskey_of_string"><a href="#val-name_dnskey_of_string" class="anchor"></a><code><span class="keyword">val </span>name_dnskey_of_string : string <span>&#45;&gt;</span> (Domain_name.t<span class="keyword"> * </span><a href="index.html#type-dnskey">dnskey</a>, [ `Msg of string ]) Stdlib.result</code></dt><dd><p><code>name_dnskey_of_string str</code> attempts to parse a domain_name, colon (':'), and a dnskey (optional flags, algorithm, base64-key).</p></dd></dl><dl><dt class="spec value" id="val-pp_dnskey"><a href="#val-pp_dnskey" class="anchor"></a><code><span class="keyword">val </span>pp_dnskey : <a href="index.html#type-dnskey">dnskey</a> Fmt.t</code></dt><dd><p><code>pp_dnskey ppf dnskey</code> pretty-prints the <code>dnskey</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec value" id="val-dnskey_to_tsig_algo"><a href="#val-dnskey_to_tsig_algo" class="anchor"></a><code><span class="keyword">val </span>dnskey_to_tsig_algo : <a href="index.html#type-dnskey">dnskey</a> <span>&#45;&gt;</span> <a href="index.html#type-tsig_algo">tsig_algo</a> option</code></dt><dd><p><code>dnskey_to_tsig_algo dnskey</code> is <code>Some tsig_algorithm</code>, or <code>None</code>.</p></dd></dl><dl><dt class="spec value" id="val-compare_dnskey"><a href="#val-compare_dnskey" class="anchor"></a><code><span class="keyword">val </span>compare_dnskey : <a href="index.html#type-dnskey">dnskey</a> <span>&#45;&gt;</span> <a href="index.html#type-dnskey">dnskey</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>compare_dnskey key key'</code> compares the keys.</p></dd></dl><dl><dt class="spec type" id="type-srv"><a href="#type-srv" class="anchor"></a><code><span class="keyword">type </span>srv</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-srv.priority" class="anchored"><td class="def field"><a href="#type-srv.priority" class="anchor"></a><code>priority : int;</code></td></tr><tr id="type-srv.weight" class="anchored"><td class="def field"><a href="#type-srv.weight" class="anchor"></a><code>weight : int;</code></td></tr><tr id="type-srv.port" class="anchored"><td class="def field"><a href="#type-srv.port" class="anchor"></a><code>port : int;</code></td></tr><tr id="type-srv.target" class="anchored"><td class="def field"><a href="#type-srv.target" class="anchor"></a><code>target : Domain_name.t;</code></td></tr></table><code>}</code></dt><dd><p>The type for service resource records.</p></dd></dl><dl><dt class="spec value" id="val-pp_srv"><a href="#val-pp_srv" class="anchor"></a><code><span class="keyword">val </span>pp_srv : <a href="index.html#type-srv">srv</a> Fmt.t</code></dt><dd><p><code>pp_srv ppf srv</code> pretty-prints <code>srv</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec value" id="val-compare_srv"><a href="#val-compare_srv" class="anchor"></a><code><span class="keyword">val </span>compare_srv : <a href="index.html#type-srv">srv</a> <span>&#45;&gt;</span> <a href="index.html#type-srv">srv</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>compare_srv srv srv'</code> compares the service records <code>srv</code> and <code>srv'</code>.</p></dd></dl><dl><dt class="spec type" id="type-caa"><a href="#type-caa" class="anchor"></a><code><span class="keyword">type </span>caa</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-caa.critical" class="anchored"><td class="def field"><a href="#type-caa.critical" class="anchor"></a><code>critical : bool;</code></td></tr><tr id="type-caa.tag" class="anchored"><td class="def field"><a href="#type-caa.tag" class="anchor"></a><code>tag : string;</code></td></tr><tr id="type-caa.value" class="anchored"><td class="def field"><a href="#type-caa.value" class="anchor"></a><code>value : string list;</code></td></tr></table><code>}</code></dt><dd><p>The type of CAA resource records.</p></dd></dl><dl><dt class="spec value" id="val-compare_caa"><a href="#val-compare_caa" class="anchor"></a><code><span class="keyword">val </span>compare_caa : <a href="index.html#type-caa">caa</a> <span>&#45;&gt;</span> <a href="index.html#type-caa">caa</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>compare_caa caa caa'</code> compare the CAA records <code>caa</code> and <code>caa'</code>.</p></dd></dl><dl><dt class="spec value" id="val-pp_caa"><a href="#val-pp_caa" class="anchor"></a><code><span class="keyword">val </span>pp_caa : <a href="index.html#type-caa">caa</a> Fmt.t</code></dt><dd><p><code>pp_caa ppf caa</code> pretty-prints the <code>caa</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec type" id="type-extension"><a href="#type-extension" class="anchor"></a><code><span class="keyword">type </span>extension</code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-extension.Nsid" class="anchored"><td class="def constructor"><a href="#type-extension.Nsid" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Nsid</span><span class="keyword"> of </span>Cstruct.t</code></td></tr><tr id="type-extension.Cookie" class="anchored"><td class="def constructor"><a href="#type-extension.Cookie" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Cookie</span><span class="keyword"> of </span>Cstruct.t</code></td></tr><tr id="type-extension.Tcp_keepalive" class="anchored"><td class="def constructor"><a href="#type-extension.Tcp_keepalive" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Tcp_keepalive</span><span class="keyword"> of </span>int option</code></td></tr><tr id="type-extension.Padding" class="anchored"><td class="def constructor"><a href="#type-extension.Padding" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Padding</span><span class="keyword"> of </span>int</code></td></tr><tr id="type-extension.Extension" class="anchored"><td class="def constructor"><a href="#type-extension.Extension" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Extension</span><span class="keyword"> of </span>int<span class="keyword"> * </span>Cstruct.t</code></td><td class="doc"><p>The type of EDNS extensions.</p></td></tr></table></dt><dt class="spec type" id="type-opt"><a href="#type-opt" class="anchor"></a><code><span class="keyword">type </span>opt</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-opt.extended_rcode" class="anchored"><td class="def field"><a href="#type-opt.extended_rcode" class="anchor"></a><code>extended_rcode : int;</code></td></tr><tr id="type-opt.version" class="anchored"><td class="def field"><a href="#type-opt.version" class="anchor"></a><code>version : int;</code></td></tr><tr id="type-opt.dnssec_ok" class="anchored"><td class="def field"><a href="#type-opt.dnssec_ok" class="anchor"></a><code>dnssec_ok : bool;</code></td></tr><tr id="type-opt.payload_size" class="anchored"><td class="def field"><a href="#type-opt.payload_size" class="anchor"></a><code>payload_size : int;</code></td></tr><tr id="type-opt.extensions" class="anchored"><td class="def field"><a href="#type-opt.extensions" class="anchor"></a><code>extensions : <a href="index.html#type-extension">extension</a> list;</code></td></tr></table><code>}</code></dt><dd><p>The type of an EDNS resource record.</p></dd></dl><dl><dt class="spec value" id="val-opt"><a href="#val-opt" class="anchor"></a><code><span class="keyword">val </span>opt : ?&#8288;extended_rcode:int <span>&#45;&gt;</span> ?&#8288;version:int <span>&#45;&gt;</span> ?&#8288;dnssec_ok:bool <span>&#45;&gt;</span> ?&#8288;payload_size:int <span>&#45;&gt;</span> ?&#8288;extensions:<a href="index.html#type-extension">extension</a> list <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="index.html#type-opt">opt</a></code></dt><dd><p><code>opt ~extended_rcode ~version ~dnssec_ok ~payload_size ~extensions ()</code> constructs an EDNS resource record type.</p></dd></dl><dl><dt class="spec value" id="val-reply_opt"><a href="#val-reply_opt" class="anchor"></a><code><span class="keyword">val </span>reply_opt : <a href="index.html#type-opt">opt</a> option <span>&#45;&gt;</span> int option<span class="keyword"> * </span><a href="index.html#type-opt">opt</a> option</code></dt><dd><p><code>reply_opt opt</code> embeds the payload size from <code>opt</code> into a new EDNS record.</p></dd></dl><dl><dt class="spec value" id="val-compare_extension"><a href="#val-compare_extension" class="anchor"></a><code><span class="keyword">val </span>compare_extension : <a href="index.html#type-extension">extension</a> <span>&#45;&gt;</span> <a href="index.html#type-extension">extension</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>compare_extension e e'</code> compares <code>e</code> with <code>e'</code>.</p></dd></dl><dl><dt class="spec value" id="val-compare_opt"><a href="#val-compare_opt" class="anchor"></a><code><span class="keyword">val </span>compare_opt : <a href="index.html#type-opt">opt</a> <span>&#45;&gt;</span> <a href="index.html#type-opt">opt</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>compare_opt opt opt'</code> compares <code>opt</code> with <code>opt'</code>.</p></dd></dl><dl><dt class="spec value" id="val-pp_extension"><a href="#val-pp_extension" class="anchor"></a><code><span class="keyword">val </span>pp_extension : <a href="index.html#type-extension">extension</a> Fmt.t</code></dt><dd><p><code>pp_extension ppf extension</code> pretty-prints the <code>extension</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec value" id="val-pp_opt"><a href="#val-pp_opt" class="anchor"></a><code><span class="keyword">val </span>pp_opt : <a href="index.html#type-opt">opt</a> Fmt.t</code></dt><dd><p><code>pp_opt ppf opt</code> pretty-prints the <code>opt</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec value" id="val-encode_opt"><a href="#val-encode_opt" class="anchor"></a><code><span class="keyword">val </span>encode_opt : <a href="index.html#type-opt">opt</a> <span>&#45;&gt;</span> Cstruct.t</code></dt><dd><p><code>encode_opt opt</code> encodes <code>opt</code> into a freshly allocated buffer.</p></dd></dl><dl><dt class="spec type" id="type-tlsa"><a href="#type-tlsa" class="anchor"></a><code><span class="keyword">type </span>tlsa</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-tlsa.tlsa_cert_usage" class="anchored"><td class="def field"><a href="#type-tlsa.tlsa_cert_usage" class="anchor"></a><code>tlsa_cert_usage : <a href="../Udns_enum/index.html#type-tlsa_cert_usage">Udns_enum.tlsa_cert_usage</a>;</code></td></tr><tr id="type-tlsa.tlsa_selector" class="anchored"><td class="def field"><a href="#type-tlsa.tlsa_selector" class="anchor"></a><code>tlsa_selector : <a href="../Udns_enum/index.html#type-tlsa_selector">Udns_enum.tlsa_selector</a>;</code></td></tr><tr id="type-tlsa.tlsa_matching_type" class="anchored"><td class="def field"><a href="#type-tlsa.tlsa_matching_type" class="anchor"></a><code>tlsa_matching_type : <a href="../Udns_enum/index.html#type-tlsa_matching_type">Udns_enum.tlsa_matching_type</a>;</code></td></tr><tr id="type-tlsa.tlsa_data" class="anchored"><td class="def field"><a href="#type-tlsa.tlsa_data" class="anchor"></a><code>tlsa_data : Cstruct.t;</code></td></tr></table><code>}</code></dt><dd><p>The type of TLSA resource records.</p></dd></dl><dl><dt class="spec value" id="val-compare_tlsa"><a href="#val-compare_tlsa" class="anchor"></a><code><span class="keyword">val </span>compare_tlsa : <a href="index.html#type-tlsa">tlsa</a> <span>&#45;&gt;</span> <a href="index.html#type-tlsa">tlsa</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>compare_tlsa tlsa tlsa'</code> compares <code>tlsa</code> with <code>tlsa'</code>.</p></dd></dl><dl><dt class="spec value" id="val-pp_tlsa"><a href="#val-pp_tlsa" class="anchor"></a><code><span class="keyword">val </span>pp_tlsa : <a href="index.html#type-tlsa">tlsa</a> Fmt.t</code></dt><dd><p><code>pp_tlsa ppf tlsa</code> pretty-prints <code>tlsa</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec type" id="type-sshfp"><a href="#type-sshfp" class="anchor"></a><code><span class="keyword">type </span>sshfp</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-sshfp.sshfp_algorithm" class="anchored"><td class="def field"><a href="#type-sshfp.sshfp_algorithm" class="anchor"></a><code>sshfp_algorithm : <a href="../Udns_enum/index.html#type-sshfp_algorithm">Udns_enum.sshfp_algorithm</a>;</code></td></tr><tr id="type-sshfp.sshfp_type" class="anchored"><td class="def field"><a href="#type-sshfp.sshfp_type" class="anchor"></a><code>sshfp_type : <a href="../Udns_enum/index.html#type-sshfp_type">Udns_enum.sshfp_type</a>;</code></td></tr><tr id="type-sshfp.sshfp_fingerprint" class="anchored"><td class="def field"><a href="#type-sshfp.sshfp_fingerprint" class="anchor"></a><code>sshfp_fingerprint : Cstruct.t;</code></td></tr></table><code>}</code></dt><dd><p>The type of SSHFP resource records.</p></dd></dl><dl><dt class="spec value" id="val-compare_sshfp"><a href="#val-compare_sshfp" class="anchor"></a><code><span class="keyword">val </span>compare_sshfp : <a href="index.html#type-sshfp">sshfp</a> <span>&#45;&gt;</span> <a href="index.html#type-sshfp">sshfp</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>compare_sshfp sshfp sshfp'</code> compares <code>sshfp</code> with <code>sshfp'</code>.</p></dd></dl><dl><dt class="spec value" id="val-pp_sshfp"><a href="#val-pp_sshfp" class="anchor"></a><code><span class="keyword">val </span>pp_sshfp : <a href="index.html#type-sshfp">sshfp</a> Fmt.t</code></dt><dd><p><code>pp_sshfp ppf sshfp</code> pretty-prints <code>sshfp</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec type" id="type-rdata"><a href="#type-rdata" class="anchor"></a><code><span class="keyword">type </span>rdata</code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-rdata.CNAME" class="anchored"><td class="def constructor"><a href="#type-rdata.CNAME" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">CNAME</span><span class="keyword"> of </span>Domain_name.t</code></td></tr><tr id="type-rdata.MX" class="anchored"><td class="def constructor"><a href="#type-rdata.MX" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">MX</span><span class="keyword"> of </span>int<span class="keyword"> * </span>Domain_name.t</code></td></tr><tr id="type-rdata.NS" class="anchored"><td class="def constructor"><a href="#type-rdata.NS" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">NS</span><span class="keyword"> of </span>Domain_name.t</code></td></tr><tr id="type-rdata.PTR" class="anchored"><td class="def constructor"><a href="#type-rdata.PTR" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">PTR</span><span class="keyword"> of </span>Domain_name.t</code></td></tr><tr id="type-rdata.SOA" class="anchored"><td class="def constructor"><a href="#type-rdata.SOA" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">SOA</span><span class="keyword"> of </span><a href="index.html#type-soa">soa</a></code></td></tr><tr id="type-rdata.TXT" class="anchored"><td class="def constructor"><a href="#type-rdata.TXT" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">TXT</span><span class="keyword"> of </span>string list</code></td></tr><tr id="type-rdata.A" class="anchored"><td class="def constructor"><a href="#type-rdata.A" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">A</span><span class="keyword"> of </span>Ipaddr.V4.t</code></td></tr><tr id="type-rdata.AAAA" class="anchored"><td class="def constructor"><a href="#type-rdata.AAAA" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">AAAA</span><span class="keyword"> of </span>Ipaddr.V6.t</code></td></tr><tr id="type-rdata.SRV" class="anchored"><td class="def constructor"><a href="#type-rdata.SRV" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">SRV</span><span class="keyword"> of </span><a href="index.html#type-srv">srv</a></code></td></tr><tr id="type-rdata.TSIG" class="anchored"><td class="def constructor"><a href="#type-rdata.TSIG" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">TSIG</span><span class="keyword"> of </span><a href="index.html#type-tsig">tsig</a></code></td></tr><tr id="type-rdata.DNSKEY" class="anchored"><td class="def constructor"><a href="#type-rdata.DNSKEY" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">DNSKEY</span><span class="keyword"> of </span><a href="index.html#type-dnskey">dnskey</a></code></td></tr><tr id="type-rdata.CAA" class="anchored"><td class="def constructor"><a href="#type-rdata.CAA" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">CAA</span><span class="keyword"> of </span><a href="index.html#type-caa">caa</a></code></td></tr><tr id="type-rdata.OPTS" class="anchored"><td class="def constructor"><a href="#type-rdata.OPTS" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">OPTS</span><span class="keyword"> of </span><a href="index.html#type-opt">opt</a></code></td></tr><tr id="type-rdata.TLSA" class="anchored"><td class="def constructor"><a href="#type-rdata.TLSA" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">TLSA</span><span class="keyword"> of </span><a href="index.html#type-tlsa">tlsa</a></code></td></tr><tr id="type-rdata.SSHFP" class="anchored"><td class="def constructor"><a href="#type-rdata.SSHFP" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">SSHFP</span><span class="keyword"> of </span><a href="index.html#type-sshfp">sshfp</a></code></td></tr><tr id="type-rdata.Raw" class="anchored"><td class="def constructor"><a href="#type-rdata.Raw" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Raw</span><span class="keyword"> of </span><a href="../Udns_enum/index.html#type-rr_typ">Udns_enum.rr_typ</a><span class="keyword"> * </span>Cstruct.t</code></td><td class="doc"><p>The type of resource record payload.</p></td></tr></table></dt></dl><dl><dt class="spec value" id="val-pp_rdata"><a href="#val-pp_rdata" class="anchor"></a><code><span class="keyword">val </span>pp_rdata : <a href="index.html#type-rdata">rdata</a> Fmt.t</code></dt><dd><p><code>pp_rdata ppf rdata</code> pretty-prints <code>rdata</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec value" id="val-rdata_name"><a href="#val-rdata_name" class="anchor"></a><code><span class="keyword">val </span>rdata_name : <a href="index.html#type-rdata">rdata</a> <span>&#45;&gt;</span> Domain_name.Set.t</code></dt><dd><p><code>rdata_name rdata</code> returns the set of refered names in <code>rdata</code>.</p></dd></dl><dl><dt class="spec value" id="val-compare_rdata"><a href="#val-compare_rdata" class="anchor"></a><code><span class="keyword">val </span>compare_rdata : <a href="index.html#type-rdata">rdata</a> <span>&#45;&gt;</span> <a href="index.html#type-rdata">rdata</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>compare_rdata rdata rdata'</code> compares <code>rdata</code> with <code>rdata'</code>.</p></dd></dl><dl><dt class="spec value" id="val-rdata_to_rr_typ"><a href="#val-rdata_to_rr_typ" class="anchor"></a><code><span class="keyword">val </span>rdata_to_rr_typ : <a href="index.html#type-rdata">rdata</a> <span>&#45;&gt;</span> <a href="../Udns_enum/index.html#type-rr_typ">Udns_enum.rr_typ</a></code></dt><dd><p><code>rdata_to_rr_typ rdata</code> is the resource record type of <code>rdata</code>.</p></dd></dl><dl><dt class="spec type" id="type-rr"><a href="#type-rr" class="anchor"></a><code><span class="keyword">type </span>rr</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-rr.name" class="anchored"><td class="def field"><a href="#type-rr.name" class="anchor"></a><code>name : Domain_name.t;</code></td></tr><tr id="type-rr.ttl" class="anchored"><td class="def field"><a href="#type-rr.ttl" class="anchor"></a><code>ttl : int32;</code></td></tr><tr id="type-rr.rdata" class="anchored"><td class="def field"><a href="#type-rr.rdata" class="anchor"></a><code>rdata : <a href="index.html#type-rdata">rdata</a>;</code></td></tr></table><code>}</code></dt><dd><p>The type of a resource record: name, time-to-live, and rdata.</p></dd></dl><dl><dt class="spec value" id="val-rr_equal"><a href="#val-rr_equal" class="anchor"></a><code><span class="keyword">val </span>rr_equal : <a href="index.html#type-rr">rr</a> <span>&#45;&gt;</span> <a href="index.html#type-rr">rr</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>rr_equal rr rr'</code> is <code>true</code> if <code>rr</code> and <code>rr'</code> are equal, <code>false</code> otherwise.</p></dd></dl><dl><dt class="spec value" id="val-rr_name"><a href="#val-rr_name" class="anchor"></a><code><span class="keyword">val </span>rr_name : <a href="index.html#type-rr">rr</a> <span>&#45;&gt;</span> Domain_name.Set.t</code></dt><dd><p><code>rr_name rr</code> is <span class="xref-unresolved" title="unresolved reference to &quot;rdata_name rr.rdata&quot;"><code>rdata_name rr</code>.rdata</span>.</p></dd></dl><dl><dt class="spec value" id="val-rr_names"><a href="#val-rr_names" class="anchor"></a><code><span class="keyword">val </span>rr_names : <a href="index.html#type-rr">rr</a> list <span>&#45;&gt;</span> Domain_name.Set.t</code></dt><dd><p><code>rr_names rrs</code> is <code>rr_name</code> folded over <code>rrs</code>.</p></dd></dl><dl><dt class="spec value" id="val-pp_rr"><a href="#val-pp_rr" class="anchor"></a><code><span class="keyword">val </span>pp_rr : <a href="index.html#type-rr">rr</a> Fmt.t</code></dt><dd><p><code>pp_rr ppf rr</code> pretty-prints the resource record <code>rr</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec value" id="val-pp_rrs"><a href="#val-pp_rrs" class="anchor"></a><code><span class="keyword">val </span>pp_rrs : <a href="index.html#type-rr">rr</a> list Fmt.t</code></dt><dd><p><code>pp_rrs ppf rrs</code> pretty-prints the resource records <code>rrs</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec type" id="type-query"><a href="#type-query" class="anchor"></a><code><span class="keyword">type </span>query</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-query.question" class="anchored"><td class="def field"><a href="#type-query.question" class="anchor"></a><code>question : <a href="index.html#type-question">question</a> list;</code></td></tr><tr id="type-query.answer" class="anchored"><td class="def field"><a href="#type-query.answer" class="anchor"></a><code>answer : <a href="index.html#type-rr">rr</a> list;</code></td></tr><tr id="type-query.authority" class="anchored"><td class="def field"><a href="#type-query.authority" class="anchor"></a><code>authority : <a href="index.html#type-rr">rr</a> list;</code></td></tr><tr id="type-query.additional" class="anchored"><td class="def field"><a href="#type-query.additional" class="anchor"></a><code>additional : <a href="index.html#type-rr">rr</a> list;</code></td></tr></table><code>}</code></dt><dd><p>The type of a DNS query.</p></dd></dl><dl><dt class="spec value" id="val-pp_query"><a href="#val-pp_query" class="anchor"></a><code><span class="keyword">val </span>pp_query : <a href="index.html#type-query">query</a> Fmt.t</code></dt><dd><p><code>pp_query ppf query</code> pretty-prints <code>query</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec type" id="type-rr_prereq"><a href="#type-rr_prereq" class="anchor"></a><code><span class="keyword">type </span>rr_prereq</code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-rr_prereq.Exists" class="anchored"><td class="def constructor"><a href="#type-rr_prereq.Exists" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Exists</span><span class="keyword"> of </span>Domain_name.t<span class="keyword"> * </span><a href="../Udns_enum/index.html#type-rr_typ">Udns_enum.rr_typ</a></code></td></tr><tr id="type-rr_prereq.Exists_data" class="anchored"><td class="def constructor"><a href="#type-rr_prereq.Exists_data" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Exists_data</span><span class="keyword"> of </span>Domain_name.t<span class="keyword"> * </span><a href="index.html#type-rdata">rdata</a></code></td></tr><tr id="type-rr_prereq.Not_exists" class="anchored"><td class="def constructor"><a href="#type-rr_prereq.Not_exists" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Not_exists</span><span class="keyword"> of </span>Domain_name.t<span class="keyword"> * </span><a href="../Udns_enum/index.html#type-rr_typ">Udns_enum.rr_typ</a></code></td></tr><tr id="type-rr_prereq.Name_inuse" class="anchored"><td class="def constructor"><a href="#type-rr_prereq.Name_inuse" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Name_inuse</span><span class="keyword"> of </span>Domain_name.t</code></td></tr><tr id="type-rr_prereq.Not_name_inuse" class="anchored"><td class="def constructor"><a href="#type-rr_prereq.Not_name_inuse" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Not_name_inuse</span><span class="keyword"> of </span>Domain_name.t</code></td><td class="doc"><p>The type of DNS update prerequisites.</p></td></tr></table></dt><dt class="spec type" id="type-rr_update"><a href="#type-rr_update" class="anchor"></a><code><span class="keyword">type </span>rr_update</code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-rr_update.Remove" class="anchored"><td class="def constructor"><a href="#type-rr_update.Remove" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Remove</span><span class="keyword"> of </span>Domain_name.t<span class="keyword"> * </span><a href="../Udns_enum/index.html#type-rr_typ">Udns_enum.rr_typ</a></code></td></tr><tr id="type-rr_update.Remove_all" class="anchored"><td class="def constructor"><a href="#type-rr_update.Remove_all" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Remove_all</span><span class="keyword"> of </span>Domain_name.t</code></td></tr><tr id="type-rr_update.Remove_single" class="anchored"><td class="def constructor"><a href="#type-rr_update.Remove_single" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Remove_single</span><span class="keyword"> of </span>Domain_name.t<span class="keyword"> * </span><a href="index.html#type-rdata">rdata</a></code></td></tr><tr id="type-rr_update.Add" class="anchored"><td class="def constructor"><a href="#type-rr_update.Add" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Add</span><span class="keyword"> of </span><a href="index.html#type-rr">rr</a></code></td><td class="doc"><p>The type of DNS update actions.</p></td></tr></table></dt></dl><dl><dt class="spec value" id="val-rr_update_name"><a href="#val-rr_update_name" class="anchor"></a><code><span class="keyword">val </span>rr_update_name : <a href="index.html#type-rr_update">rr_update</a> <span>&#45;&gt;</span> Domain_name.t</code></dt><dd><p><code>rr_update_name update</code> is the name used in the <code>update</code>.</p></dd></dl><dl><dt class="spec value" id="val-pp_rr_update"><a href="#val-pp_rr_update" class="anchor"></a><code><span class="keyword">val </span>pp_rr_update : <a href="index.html#type-rr_update">rr_update</a> Fmt.t</code></dt><dd><p><code>pp_rr_update ppf rr_update</code> pretty-prints the <code>rr_update</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec type" id="type-update"><a href="#type-update" class="anchor"></a><code><span class="keyword">type </span>update</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-update.zone" class="anchored"><td class="def field"><a href="#type-update.zone" class="anchor"></a><code>zone : <a href="index.html#type-question">question</a>;</code></td></tr><tr id="type-update.prereq" class="anchored"><td class="def field"><a href="#type-update.prereq" class="anchor"></a><code>prereq : <a href="index.html#type-rr_prereq">rr_prereq</a> list;</code></td></tr><tr id="type-update.update" class="anchored"><td class="def field"><a href="#type-update.update" class="anchor"></a><code>update : <a href="index.html#type-rr_update">rr_update</a> list;</code></td></tr><tr id="type-update.addition" class="anchored"><td class="def field"><a href="#type-update.addition" class="anchor"></a><code>addition : <a href="index.html#type-rr">rr</a> list;</code></td></tr></table><code>}</code></dt><dd><p>The type of a DNS update packet.</p></dd></dl><dl><dt class="spec value" id="val-pp_update"><a href="#val-pp_update" class="anchor"></a><code><span class="keyword">val </span>pp_update : <a href="index.html#type-update">update</a> Fmt.t</code></dt><dd><p><code>pp_update ppf update</code> pretty-prints <code>update</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec type" id="type-v"><a href="#type-v" class="anchor"></a><code><span class="keyword">type </span>v</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-v.Query" class="anchored"><td class="def constructor"><a href="#type-v.Query" class="anchor"></a><code><span class="keyword">| </span></code><code>`Query<span class="keyword"> of </span><a href="index.html#type-query">query</a></code></td></tr><tr id="type-v.Update" class="anchored"><td class="def constructor"><a href="#type-v.Update" class="anchor"></a><code><span class="keyword">| </span></code><code>`Update<span class="keyword"> of </span><a href="index.html#type-update">update</a></code></td></tr><tr id="type-v.Notify" class="anchored"><td class="def constructor"><a href="#type-v.Notify" class="anchor"></a><code><span class="keyword">| </span></code><code>`Notify<span class="keyword"> of </span><a href="index.html#type-query">query</a></code></td></tr></table><code> ]</code></dt><dd><p>The type of a DNS packet value.</p></dd></dl><dl><dt class="spec value" id="val-pp_v"><a href="#val-pp_v" class="anchor"></a><code><span class="keyword">val </span>pp_v : <a href="index.html#type-v">v</a> Fmt.t</code></dt><dd><p><code>pp_v ppf v</code> pretty-prints the DNS packet value <code>v</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type </span>t</code><code><span class="keyword"> = </span><a href="index.html#type-header">header</a><span class="keyword"> * </span><a href="index.html#type-v">v</a><span class="keyword"> * </span><a href="index.html#type-opt">opt</a> option<span class="keyword"> * </span>(Domain_name.t<span class="keyword"> * </span><a href="index.html#type-tsig">tsig</a>) option</code></dt><dd><p>The type of a DNS packet: header, value, optionally EDNS, and an optional signature (name, tsig).</p></dd></dl><dl><dt class="spec value" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span class="keyword">val </span>pp : <a href="index.html#type-t">t</a> Fmt.t</code></dt><dd><p><code>pp ppf t</code> pretty-prints <code>t</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec type" id="type-tsig_verify"><a href="#type-tsig_verify" class="anchor"></a><code><span class="keyword">type </span>tsig_verify</code><code><span class="keyword"> = </span>?&#8288;mac:Cstruct.t <span>&#45;&gt;</span> Ptime.t <span>&#45;&gt;</span> <a href="index.html#type-v">v</a> <span>&#45;&gt;</span> <a href="index.html#type-header">header</a> <span>&#45;&gt;</span> Domain_name.t <span>&#45;&gt;</span> key:<a href="index.html#type-dnskey">dnskey</a> option <span>&#45;&gt;</span> <a href="index.html#type-tsig">tsig</a> <span>&#45;&gt;</span> Cstruct.t <span>&#45;&gt;</span> (<a href="index.html#type-tsig">tsig</a><span class="keyword"> * </span>Cstruct.t<span class="keyword"> * </span><a href="index.html#type-dnskey">dnskey</a>, Cstruct.t option) Stdlib.result</code></dt><dd><p>The type of a tsig_verify function.</p></dd></dl><dl><dt class="spec type" id="type-tsig_sign"><a href="#type-tsig_sign" class="anchor"></a><code><span class="keyword">type </span>tsig_sign</code><code><span class="keyword"> = </span>?&#8288;mac:Cstruct.t <span>&#45;&gt;</span> ?&#8288;max_size:int <span>&#45;&gt;</span> Domain_name.t <span>&#45;&gt;</span> <a href="index.html#type-tsig">tsig</a> <span>&#45;&gt;</span> key:<a href="index.html#type-dnskey">dnskey</a> <span>&#45;&gt;</span> Cstruct.t <span>&#45;&gt;</span> (Cstruct.t<span class="keyword"> * </span>Cstruct.t) option</code></dt><dd><p>The type of a tsig_sign function.</p></dd></dl><dl><dt class="spec value" id="val-decode"><a href="#val-decode" class="anchor"></a><code><span class="keyword">val </span>decode : Cstruct.t <span>&#45;&gt;</span> (<a href="index.html#type-t">t</a><span class="keyword"> * </span>int option, [&gt; <a href="../Udns_name/index.html#type-err">Udns_name.err</a><span class="keyword"> | </span>`BadOpcode of int<span class="keyword"> | </span>`BadRcode of int<span class="keyword"> | </span>`UnsupportedOpcode of <a href="../Udns_enum/index.html#type-opcode">Udns_enum.opcode</a><span class="keyword"> | </span>`BadTTL of int32<span class="keyword"> | </span>`BadRRTyp of int<span class="keyword"> | </span>`DisallowedRRTyp of <a href="../Udns_enum/index.html#type-rr_typ">Udns_enum.rr_typ</a><span class="keyword"> | </span>`BadClass of int<span class="keyword"> | </span>`DisallowedClass of <a href="../Udns_enum/index.html#type-clas">Udns_enum.clas</a><span class="keyword"> | </span>`UnsupportedClass of <a href="../Udns_enum/index.html#type-clas">Udns_enum.clas</a><span class="keyword"> | </span>`BadProto of int<span class="keyword"> | </span>`BadAlgorithm of int<span class="keyword"> | </span>`BadOpt<span class="keyword"> | </span>`BadKeepalive<span class="keyword"> | </span>`BadCaaTag<span class="keyword"> | </span>`LeftOver<span class="keyword"> | </span>`InvalidTimestamp of int64<span class="keyword"> | </span>`InvalidAlgorithm of Domain_name.t<span class="keyword"> | </span>`NonZeroTTL of int32<span class="keyword"> | </span>`NonZeroRdlen of int<span class="keyword"> | </span>`InvalidZoneCount of int<span class="keyword"> | </span>`InvalidZoneRR of <a href="../Udns_enum/index.html#type-rr_typ">Udns_enum.rr_typ</a><span class="keyword"> | </span>`BadTlsaCertUsage of int<span class="keyword"> | </span>`BadTlsaSelector of int<span class="keyword"> | </span>`BadTlsaMatchingType of int<span class="keyword"> | </span>`BadSshfpAlgorithm of int<span class="keyword"> | </span>`BadSshfpType of int<span class="keyword"> | </span>`Bad_edns_version of int<span class="keyword"> | </span>`Multiple_tsig<span class="keyword"> | </span>`Multiple_edns<span class="keyword"> | </span>`Tsig_not_last ]) Stdlib.result</code></dt><dd><p><code>decode buf</code> decodes the buffer into a DNS packet, and optionally an offset to the last resource record (TSIG is computed over the encoded packet without TSIG). Any error may occur.</p></dd></dl><dl><dt class="spec value" id="val-encode"><a href="#val-encode" class="anchor"></a><code><span class="keyword">val </span>encode : ?&#8288;max_size:int <span>&#45;&gt;</span> ?&#8288;edns:<a href="index.html#type-opt">opt</a> <span>&#45;&gt;</span> <a href="index.html#type-proto">proto</a> <span>&#45;&gt;</span> <a href="index.html#type-header">header</a> <span>&#45;&gt;</span> <a href="index.html#type-v">v</a> <span>&#45;&gt;</span> Cstruct.t<span class="keyword"> * </span>int</code></dt><dd><p><code>encode ~max_size ~edns proto header v</code> encodes <code>header</code> and <code>v</code> into a freshly allocated buffer, <code>edns</code> is appended. If the buffer would exceed <code>max_size</code> or <code>proto</code> restrictions, the truncation bit is set.</p></dd></dl><dl><dt class="spec value" id="val-error"><a href="#val-error" class="anchor"></a><code><span class="keyword">val </span>error : <a href="index.html#type-header">header</a> <span>&#45;&gt;</span> <a href="index.html#type-v">v</a> <span>&#45;&gt;</span> <a href="../Udns_enum/index.html#type-rcode">Udns_enum.rcode</a> <span>&#45;&gt;</span> (Cstruct.t<span class="keyword"> * </span>int) option</code></dt><dd><p><code>error hdr v rcode</code> encodes a DNS error with the given header, and the first question taken from <code>v</code>. If the query bit in <code>hdr</code> is set, nothing is returned (never reply to a reply).</p></dd></dl></div></body></html>